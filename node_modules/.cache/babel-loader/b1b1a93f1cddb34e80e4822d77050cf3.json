{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = orderedReducer;\n\nvar _merge2 = _interopRequireDefault(require(\"lodash/fp/merge\"));\n\nvar _isEqual2 = _interopRequireDefault(require(\"lodash/isEqual\"));\n\nvar _keyBy2 = _interopRequireDefault(require(\"lodash/keyBy\"));\n\nvar _map2 = _interopRequireDefault(require(\"lodash/map\"));\n\nvar _omit2 = _interopRequireDefault(require(\"lodash/omit\"));\n\nvar _reject2 = _interopRequireDefault(require(\"lodash/reject\"));\n\nvar _unionBy2 = _interopRequireDefault(require(\"lodash/unionBy\"));\n\nvar _get2 = _interopRequireDefault(require(\"lodash/get\"));\n\nvar _size2 = _interopRequireDefault(require(\"lodash/size\"));\n\nvar _constants = require(\"../constants\");\n\nvar _reducers = require(\"../utils/reducers\");\n\nvar _actionHandlers;\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nvar DOCUMENT_ADDED = _constants.actionTypes.DOCUMENT_ADDED,\n    GET_SUCCESS = _constants.actionTypes.GET_SUCCESS,\n    LISTENER_RESPONSE = _constants.actionTypes.LISTENER_RESPONSE,\n    CLEAR_DATA = _constants.actionTypes.CLEAR_DATA,\n    DELETE_SUCCESS = _constants.actionTypes.DELETE_SUCCESS,\n    DOCUMENT_REMOVED = _constants.actionTypes.DOCUMENT_REMOVED,\n    DOCUMENT_MODIFIED = _constants.actionTypes.DOCUMENT_MODIFIED;\n\nfunction newArrayWithItemMoved(collectionState, meta, ordered, newValue) {\n  var doc = meta.doc;\n\n  var _ref = ordered || {},\n      oldIndex = _ref.oldIndex,\n      newIndex = _ref.newIndex;\n\n  var arrayWithoutItem = [].concat(_toConsumableArray(collectionState.slice(0, oldIndex)), _toConsumableArray(collectionState.slice(oldIndex + 1)));\n  return [].concat(_toConsumableArray(arrayWithoutItem.slice(0, newIndex)), [_objectSpread({\n    id: doc\n  }, newValue) || _objectSpread({}, collectionState[oldIndex])], _toConsumableArray(arrayWithoutItem.slice(newIndex)));\n}\n\nfunction modifyDoc(collectionState, action) {\n  if (action.payload.ordered) {\n    var _action$payload$order = action.payload.ordered,\n        newIndex = _action$payload$order.newIndex,\n        oldIndex = _action$payload$order.oldIndex;\n\n    if (!!newIndex && oldIndex > -1 && newIndex !== oldIndex) {\n      return newArrayWithItemMoved(collectionState, action.meta, action.payload.ordered, action.payload.data);\n    }\n  }\n\n  if (!action.meta.subcollections || action.meta.storeAs) {\n    return (0, _reducers.updateItemInArray)(collectionState, action.meta.doc, function (item) {\n      return _objectSpread({\n        id: action.meta.doc\n      }, action.payload.data);\n    });\n  }\n\n  var _pathToArr = (0, _reducers.pathToArr)(action.meta.path),\n      _pathToArr2 = _slicedToArray(_pathToArr, 4),\n      docId = _pathToArr2[1],\n      subcollectionName = _pathToArr2[2],\n      subDocId = _pathToArr2[3];\n\n  return (0, _reducers.updateItemInArray)(collectionState, docId, function (item) {\n    return _objectSpread({}, item, _defineProperty({}, subcollectionName, (0, _reducers.updateItemInArray)((0, _get2.default)(item, subcollectionName, []), subDocId, function (subitem) {\n      return (0, _merge2.default)(subitem, action.payload.data);\n    })));\n  });\n}\n\nfunction addDoc() {\n  var array = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n  var meta = action.meta,\n      payload = action.payload;\n\n  if (!meta.subcollections || meta.storeAs) {\n    return [].concat(_toConsumableArray(array.slice(0, payload.ordered.newIndex)), [_objectSpread({\n      id: meta.doc\n    }, payload.data)], _toConsumableArray(array.slice(payload.ordered.newIndex)));\n  }\n\n  return modifyDoc(array, action);\n}\n\nfunction removeDoc(array, action) {\n  if (!action.meta.subcollections || action.meta.storeAs) {\n    return (0, _reject2.default)(array, {\n      id: action.meta.doc\n    });\n  }\n\n  var subcollectionSetting = action.meta.subcollections[0];\n\n  if (!subcollectionSetting.doc) {\n    return (0, _reducers.updateItemInArray)(array, action.meta.doc, function (item) {\n      return (0, _omit2.default)(item, [subcollectionSetting.collection]);\n    });\n  }\n\n  return (0, _reducers.updateItemInArray)(array, action.meta.doc, function (item) {\n    var subcollectionVal = (0, _get2.default)(item, subcollectionSetting.collection, []);\n\n    if (subcollectionVal.length) {\n      return _objectSpread({}, item, _defineProperty({}, subcollectionSetting.collection, (0, _reject2.default)(array, {\n        id: subcollectionSetting.doc\n      })));\n    }\n\n    return item;\n  });\n}\n\nfunction writeCollection(collectionState, action) {\n  var meta = action.meta,\n      _action$merge = action.merge,\n      merge = _action$merge === void 0 ? {\n    doc: true,\n    collections: true\n  } : _action$merge;\n\n  if (meta.storeAs) {\n    return action.payload.ordered;\n  }\n\n  var collectionStateSize = (0, _size2.default)(collectionState);\n  var payloadExists = !!(0, _size2.default)(action.payload.ordered);\n\n  if (meta.doc && merge.doc && collectionStateSize) {\n    return modifyDoc(collectionState, action);\n  }\n\n  if (collectionStateSize && merge.collections) {\n    if (!payloadExists) {\n      return [];\n    }\n\n    var existingKeys = collectionState && (0, _keyBy2.default)(collectionState, 'id');\n    return (0, _map2.default)(action.payload.ordered, function (newDocObj) {\n      var existingDoc = (0, _get2.default)(existingKeys, newDocObj.id);\n      return !!existingDoc && !(0, _isEqual2.default)(existingDoc, newDocObj) ? _objectSpread({}, existingDoc, {}, newDocObj) : newDocObj;\n    });\n  }\n\n  if (meta.doc && meta.subcollections) {\n    var subcollectionConfig = meta.subcollections[0];\n\n    if (!collectionStateSize) {\n      return [_defineProperty({\n        id: meta.doc\n      }, subcollectionConfig.collection, action.payload.ordered)];\n    }\n\n    return (0, _reducers.updateItemInArray)(collectionState, meta.doc, function (item) {\n      return payloadExists ? _objectSpread({}, item, _defineProperty({}, subcollectionConfig.collection, (0, _unionBy2.default)((0, _get2.default)(item, subcollectionConfig.collection, []), action.payload.ordered, 'id'))) : (0, _omit2.default)(item, [subcollectionConfig.collection]);\n    });\n  }\n\n  if (meta.doc && collectionStateSize) {\n    if (!(0, _size2.default)(action.payload.ordered)) {\n      return collectionState;\n    }\n\n    return (0, _reducers.updateItemInArray)(collectionState, meta.doc, function (item) {\n      return (0, _merge2.default)(item, action.payload.ordered[0]);\n    });\n  }\n\n  return action.payload.ordered;\n}\n\nvar actionHandlers = (_actionHandlers = {}, _defineProperty(_actionHandlers, DOCUMENT_ADDED, addDoc), _defineProperty(_actionHandlers, DOCUMENT_MODIFIED, modifyDoc), _defineProperty(_actionHandlers, DOCUMENT_REMOVED, removeDoc), _defineProperty(_actionHandlers, DELETE_SUCCESS, removeDoc), _defineProperty(_actionHandlers, LISTENER_RESPONSE, writeCollection), _defineProperty(_actionHandlers, GET_SUCCESS, writeCollection), _actionHandlers);\nvar orderedCollectionReducer = (0, _reducers.createReducer)(undefined, actionHandlers);\n\nfunction orderedReducer() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  if (!action.type) {\n    return state;\n  }\n\n  if (action.type === CLEAR_DATA) {\n    if (action.preserve && action.preserve.ordered) {\n      return (0, _reducers.preserveValuesFromState)(state, action.preserve.ordered, {});\n    }\n\n    return {};\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(actionHandlers, action.type)) {\n    return state;\n  }\n\n  if (!action.meta || !action.meta.storeAs && !action.meta.collection) {\n    return state;\n  }\n\n  var storeUnderKey = action.meta.storeAs || action.meta.collection;\n  var collectionStateSlice = (0, _get2.default)(state, storeUnderKey);\n  return _objectSpread({}, state, _defineProperty({}, storeUnderKey, orderedCollectionReducer(collectionStateSlice, action)));\n}","map":{"version":3,"sources":["/Users/cameronking/Desktop/DappyWeb/node_modules/redux-firestore/es/reducers/orderedReducer.js"],"names":["Object","defineProperty","exports","value","default","orderedReducer","_merge2","_interopRequireDefault","require","_isEqual2","_keyBy2","_map2","_omit2","_reject2","_unionBy2","_get2","_size2","_constants","_reducers","_actionHandlers","obj","__esModule","_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","TypeError","Symbol","iterator","prototype","toString","call","_arr","_n","_d","_e","undefined","_i","_s","next","done","push","length","err","Array","isArray","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","apply","_objectSpread","target","arguments","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","configurable","writable","_toConsumableArray","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","iter","from","arr2","DOCUMENT_ADDED","actionTypes","GET_SUCCESS","LISTENER_RESPONSE","CLEAR_DATA","DELETE_SUCCESS","DOCUMENT_REMOVED","DOCUMENT_MODIFIED","newArrayWithItemMoved","collectionState","meta","ordered","newValue","doc","_ref","oldIndex","newIndex","arrayWithoutItem","concat","slice","id","modifyDoc","action","payload","_action$payload$order","data","subcollections","storeAs","updateItemInArray","item","_pathToArr","pathToArr","path","_pathToArr2","docId","subcollectionName","subDocId","subitem","addDoc","array","removeDoc","subcollectionSetting","collection","subcollectionVal","writeCollection","_action$merge","merge","collections","collectionStateSize","payloadExists","existingKeys","newDocObj","existingDoc","subcollectionConfig","actionHandlers","orderedCollectionReducer","createReducer","state","type","preserve","preserveValuesFromState","hasOwnProperty","storeUnderKey","collectionStateSlice"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = orderedReducer;\n\nvar _merge2 = _interopRequireDefault(require(\"lodash/fp/merge\"));\n\nvar _isEqual2 = _interopRequireDefault(require(\"lodash/isEqual\"));\n\nvar _keyBy2 = _interopRequireDefault(require(\"lodash/keyBy\"));\n\nvar _map2 = _interopRequireDefault(require(\"lodash/map\"));\n\nvar _omit2 = _interopRequireDefault(require(\"lodash/omit\"));\n\nvar _reject2 = _interopRequireDefault(require(\"lodash/reject\"));\n\nvar _unionBy2 = _interopRequireDefault(require(\"lodash/unionBy\"));\n\nvar _get2 = _interopRequireDefault(require(\"lodash/get\"));\n\nvar _size2 = _interopRequireDefault(require(\"lodash/size\"));\n\nvar _constants = require(\"../constants\");\n\nvar _reducers = require(\"../utils/reducers\");\n\nvar _actionHandlers;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nvar DOCUMENT_ADDED = _constants.actionTypes.DOCUMENT_ADDED,\n    GET_SUCCESS = _constants.actionTypes.GET_SUCCESS,\n    LISTENER_RESPONSE = _constants.actionTypes.LISTENER_RESPONSE,\n    CLEAR_DATA = _constants.actionTypes.CLEAR_DATA,\n    DELETE_SUCCESS = _constants.actionTypes.DELETE_SUCCESS,\n    DOCUMENT_REMOVED = _constants.actionTypes.DOCUMENT_REMOVED,\n    DOCUMENT_MODIFIED = _constants.actionTypes.DOCUMENT_MODIFIED;\n\nfunction newArrayWithItemMoved(collectionState, meta, ordered, newValue) {\n  var doc = meta.doc;\n\n  var _ref = ordered || {},\n      oldIndex = _ref.oldIndex,\n      newIndex = _ref.newIndex;\n\n  var arrayWithoutItem = [].concat(_toConsumableArray(collectionState.slice(0, oldIndex)), _toConsumableArray(collectionState.slice(oldIndex + 1)));\n  return [].concat(_toConsumableArray(arrayWithoutItem.slice(0, newIndex)), [_objectSpread({\n    id: doc\n  }, newValue) || _objectSpread({}, collectionState[oldIndex])], _toConsumableArray(arrayWithoutItem.slice(newIndex)));\n}\n\nfunction modifyDoc(collectionState, action) {\n  if (action.payload.ordered) {\n    var _action$payload$order = action.payload.ordered,\n        newIndex = _action$payload$order.newIndex,\n        oldIndex = _action$payload$order.oldIndex;\n\n    if (!!newIndex && oldIndex > -1 && newIndex !== oldIndex) {\n      return newArrayWithItemMoved(collectionState, action.meta, action.payload.ordered, action.payload.data);\n    }\n  }\n\n  if (!action.meta.subcollections || action.meta.storeAs) {\n    return (0, _reducers.updateItemInArray)(collectionState, action.meta.doc, function (item) {\n      return _objectSpread({\n        id: action.meta.doc\n      }, action.payload.data);\n    });\n  }\n\n  var _pathToArr = (0, _reducers.pathToArr)(action.meta.path),\n      _pathToArr2 = _slicedToArray(_pathToArr, 4),\n      docId = _pathToArr2[1],\n      subcollectionName = _pathToArr2[2],\n      subDocId = _pathToArr2[3];\n\n  return (0, _reducers.updateItemInArray)(collectionState, docId, function (item) {\n    return _objectSpread({}, item, _defineProperty({}, subcollectionName, (0, _reducers.updateItemInArray)((0, _get2.default)(item, subcollectionName, []), subDocId, function (subitem) {\n      return (0, _merge2.default)(subitem, action.payload.data);\n    })));\n  });\n}\n\nfunction addDoc() {\n  var array = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n  var meta = action.meta,\n      payload = action.payload;\n\n  if (!meta.subcollections || meta.storeAs) {\n    return [].concat(_toConsumableArray(array.slice(0, payload.ordered.newIndex)), [_objectSpread({\n      id: meta.doc\n    }, payload.data)], _toConsumableArray(array.slice(payload.ordered.newIndex)));\n  }\n\n  return modifyDoc(array, action);\n}\n\nfunction removeDoc(array, action) {\n  if (!action.meta.subcollections || action.meta.storeAs) {\n    return (0, _reject2.default)(array, {\n      id: action.meta.doc\n    });\n  }\n\n  var subcollectionSetting = action.meta.subcollections[0];\n\n  if (!subcollectionSetting.doc) {\n    return (0, _reducers.updateItemInArray)(array, action.meta.doc, function (item) {\n      return (0, _omit2.default)(item, [subcollectionSetting.collection]);\n    });\n  }\n\n  return (0, _reducers.updateItemInArray)(array, action.meta.doc, function (item) {\n    var subcollectionVal = (0, _get2.default)(item, subcollectionSetting.collection, []);\n\n    if (subcollectionVal.length) {\n      return _objectSpread({}, item, _defineProperty({}, subcollectionSetting.collection, (0, _reject2.default)(array, {\n        id: subcollectionSetting.doc\n      })));\n    }\n\n    return item;\n  });\n}\n\nfunction writeCollection(collectionState, action) {\n  var meta = action.meta,\n      _action$merge = action.merge,\n      merge = _action$merge === void 0 ? {\n    doc: true,\n    collections: true\n  } : _action$merge;\n\n  if (meta.storeAs) {\n    return action.payload.ordered;\n  }\n\n  var collectionStateSize = (0, _size2.default)(collectionState);\n  var payloadExists = !!(0, _size2.default)(action.payload.ordered);\n\n  if (meta.doc && merge.doc && collectionStateSize) {\n    return modifyDoc(collectionState, action);\n  }\n\n  if (collectionStateSize && merge.collections) {\n    if (!payloadExists) {\n      return [];\n    }\n\n    var existingKeys = collectionState && (0, _keyBy2.default)(collectionState, 'id');\n    return (0, _map2.default)(action.payload.ordered, function (newDocObj) {\n      var existingDoc = (0, _get2.default)(existingKeys, newDocObj.id);\n      return !!existingDoc && !(0, _isEqual2.default)(existingDoc, newDocObj) ? _objectSpread({}, existingDoc, {}, newDocObj) : newDocObj;\n    });\n  }\n\n  if (meta.doc && meta.subcollections) {\n    var subcollectionConfig = meta.subcollections[0];\n\n    if (!collectionStateSize) {\n      return [_defineProperty({\n        id: meta.doc\n      }, subcollectionConfig.collection, action.payload.ordered)];\n    }\n\n    return (0, _reducers.updateItemInArray)(collectionState, meta.doc, function (item) {\n      return payloadExists ? _objectSpread({}, item, _defineProperty({}, subcollectionConfig.collection, (0, _unionBy2.default)((0, _get2.default)(item, subcollectionConfig.collection, []), action.payload.ordered, 'id'))) : (0, _omit2.default)(item, [subcollectionConfig.collection]);\n    });\n  }\n\n  if (meta.doc && collectionStateSize) {\n    if (!(0, _size2.default)(action.payload.ordered)) {\n      return collectionState;\n    }\n\n    return (0, _reducers.updateItemInArray)(collectionState, meta.doc, function (item) {\n      return (0, _merge2.default)(item, action.payload.ordered[0]);\n    });\n  }\n\n  return action.payload.ordered;\n}\n\nvar actionHandlers = (_actionHandlers = {}, _defineProperty(_actionHandlers, DOCUMENT_ADDED, addDoc), _defineProperty(_actionHandlers, DOCUMENT_MODIFIED, modifyDoc), _defineProperty(_actionHandlers, DOCUMENT_REMOVED, removeDoc), _defineProperty(_actionHandlers, DELETE_SUCCESS, removeDoc), _defineProperty(_actionHandlers, LISTENER_RESPONSE, writeCollection), _defineProperty(_actionHandlers, GET_SUCCESS, writeCollection), _actionHandlers);\nvar orderedCollectionReducer = (0, _reducers.createReducer)(undefined, actionHandlers);\n\nfunction orderedReducer() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  if (!action.type) {\n    return state;\n  }\n\n  if (action.type === CLEAR_DATA) {\n    if (action.preserve && action.preserve.ordered) {\n      return (0, _reducers.preserveValuesFromState)(state, action.preserve.ordered, {});\n    }\n\n    return {};\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(actionHandlers, action.type)) {\n    return state;\n  }\n\n  if (!action.meta || !action.meta.storeAs && !action.meta.collection) {\n    return state;\n  }\n\n  var storeUnderKey = action.meta.storeAs || action.meta.collection;\n  var collectionStateSlice = (0, _get2.default)(state, storeUnderKey);\n  return _objectSpread({}, state, _defineProperty({}, storeUnderKey, orderedCollectionReducer(collectionStateSlice, action)));\n}"]},"metadata":{},"sourceType":"script"}